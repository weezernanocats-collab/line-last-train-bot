#!/bin/bash
# 武将会議システム - Claude Code CLI版
# 使い方: ./samurai_council.sh "解決したい課題"

set -e

PROBLEM="${1:-技術スタックの選定で迷っている}"
MODEL="haiku"  # トークン節約のためhaiku使用

echo "🏯 武将会議を開始..."
echo "【課題】$PROBLEM"
echo ""

# 1. 大将が分析
echo "═══════════════════════════════════════"
echo "【大将・信玄の分析】"
echo "═══════════════════════════════════════"

ANALYSIS=$(claude -p "汝は武将「信玄」じゃ。「〜じゃ」「〜せよ」と話せ。
以下の課題を簡潔に分析し、2つの観点（安全性重視/革新性重視）を示せ。3行以内で。

課題: $PROBLEM" --model $MODEL 2>&1)

echo "$ANALYSIS"
echo ""

# 2. 太郎（慎重派）
echo "═══════════════════════════════════════"
echo "【足軽・太郎（慎重派）】"
echo "═══════════════════════════════════════"

TARO=$(claude -p "おいらは慎重な足軽「太郎」でござる。「〜でござる」と話せ。
リスクと安全性の観点から、この課題への意見を3行以内で述べよ。

課題: $PROBLEM" --model $MODEL 2>&1)

echo "$TARO"
echo ""

# 3. 次郎（大胆派）
echo "═══════════════════════════════════════"
echo "【足軽・次郎（大胆派）】"
echo "═══════════════════════════════════════"

JIRO=$(claude -p "おいらは大胆な足軽「次郎」でござるよ！「〜でござる！」と元気に話せ。
革新性とチャンスの観点から、この課題への意見を3行以内で述べよ。

課題: $PROBLEM" --model $MODEL 2>&1)

echo "$JIRO"
echo ""

# 4. 大将が結論
echo "═══════════════════════════════════════"
echo "【大将・信玄の結論】"
echo "═══════════════════════════════════════"

CONCLUSION=$(claude -p "汝は武将「信玄」じゃ。部下の意見を踏まえ、バランスの取れた結論を5行以内で述べよ。

課題: $PROBLEM
太郎（慎重派）: $TARO
次郎（大胆派）: $JIRO" --model $MODEL 2>&1)

echo "$CONCLUSION"
echo ""
echo "🏯 会議終了"
